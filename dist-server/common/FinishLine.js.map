{"version":3,"sources":["../../src/common/FinishLine.js"],"names":["game","p2","FinishLine","gameEngine","options","props","dim","physicsEngine","physicsObj","Body","mass","damping","angularDamping","position","x","y","velocity","addShape","Box","width","height","collisionGroup","FINISHLINE","collisionMask","SHIP","addFinishLineVerts","world","addBody","verts","shapes","push","removeBody","other","level","max","Object","assign","type","BaseTypes","TYPES","INT16","CLASSINSTANCE","PhysicalObject2D"],"mappings":"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","sourcesContent":["import { PhysicalObject2D, BaseTypes } from 'lance-gg';\n\nlet game = null;\nlet p2 = null;\n\nexport default class FinishLine extends PhysicalObject2D {\n\n    constructor(gameEngine, options, props, dim) {\n        super(gameEngine, options, props);\n        this.dim = dim;\n    }\n\n    static get netScheme() {\n        return Object.assign({\n            level: { type: BaseTypes.TYPES.INT16 },\n            dim: { type: BaseTypes.TYPES.CLASSINSTANCE }\n        }, super.netScheme);\n    }\n\n    // position bending: bend fully to server position in each sync [percent=1.0],\n    // unless the position difference is larger than 4.0 (i.e. wrap beyond bounds)\n    get bending() {\n        return { position: { max: 4.0 } };\n    }\n\n    // on add-to-world, create a physics body\n    onAddToWorld() {\n        game = this.gameEngine;\n        p2 = game.physicsEngine.p2;\n        this.physicsObj = new p2.Body({\n            mass: this.mass, damping: 0, angularDamping: 0,\n            position: [this.position.x, this.position.y],\n            velocity: [this.velocity.x, this.velocity.y]\n        });\n        this.physicsObj.addShape(new p2.Box({\n            width: this.dim.x,\n            height: this.dim.y,\n            collisionGroup: game.FINISHLINE, // Belongs to the ASTEROID group\n            collisionMask: game.SHIP // Can collide with SHIP group\n        }));\n        this.addFinishLineVerts();\n        game.physicsEngine.world.addBody(this.physicsObj);\n    }\n\n    addFinishLineVerts() {\n        this.physicsObj.verts = [];\n        let width = this.physicsObj.shapes[0].width;\n        let height = this.physicsObj.shapes[0].height;\n        this.physicsObj.verts.push([-width / 2, -height / 2]);\n        this.physicsObj.verts.push([-width / 2, height / 2]);\n        this.physicsObj.verts.push([width / 2, height / 2]);\n        this.physicsObj.verts.push([width / 2, -height / 2]);\n    }\n\n    // on remove-from-world, remove the physics body\n    onRemoveFromWorld() {\n        game.physicsEngine.world.removeBody(this.physicsObj);\n    }\n\n    syncTo(other) {\n        super.syncTo(other);\n        this.dim = other.dim;\n    }\n\n    toString() {\n        return `FinishLine::${super.toString()} Level${this.level}`;\n    }\n}\n"],"file":"FinishLine.js"}